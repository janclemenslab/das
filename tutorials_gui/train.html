<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Predict" href="predict.html" /><link rel="prev" title="Annotate song" href="annotate.html" />

    <!-- Generated with Sphinx 4.5.0 and Furo 2023.03.27 -->
        <title>Train - DAS documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/css/lightbox.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">DAS  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/icon.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart_fly.html">Quick start tutorial (fly)</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="tutorials_gui.html">GUI documentation</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="load.html">Load and view data</a></li>
<li class="toctree-l2"><a class="reference internal" href="annotate.html">Annotate song</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Train</a></li>
<li class="toctree-l2"><a class="reference internal" href="predict.html">Predict</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/tutorials.html">Programming documentation</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/convert.html">Convert your own annotations and audio data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/make_ds_notebook.html">Make a dataset from custom data formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/train.html">Train</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/predict.html">Predict</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/colab.html">Training and inference with colab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/structparams.html">Choice of structural network parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/architecture_tuning.html">Architecture tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/experiment_tracking.html">Experiment tracking with Weights &amp; Biases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/label_segments.html">Generate segment labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/evaluate_fly.html">Evaluate a sine and pulse network</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/evaluate_bird.html">Evaluate a bird song network</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/realtime.html">Annotate audio in realtime</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../unsupervised/unsupervised.html">Unsupervised classification</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../unsupervised/flies.html">Courtship song of flies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unsupervised/birds.html">Song of Bengalese finches</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unsupervised/mice.html">Ultrasonic vocalizations from mice</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../technical/technical.html">Technical details</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../technical/cli.html">Command line interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../technical/data_formats.html">Data formats</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api.html">Developer API</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/das.annot.html">das.annot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.augmentation.html">das.augmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.block_stratify.html">das.block_stratify</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.data.html">das.data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.data_hash.html">das.data_hash</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.evaluate.html">das.evaluate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.event_utils.html">das.event_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.io.html">das.io</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.make_dataset.html">das.make_dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.menagerie.html">das.menagerie</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.models.html">das.models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.models_legacy.html">das.models_legacy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.npy_dir.html">das.npy_dir</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.postprocessing.html">das.postprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.predict.html">das.predict</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.pulse_utils.html">das.pulse_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.segment_utils.html">das.segment_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.spec_utils.html">das.spec_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.tracking.html">das.tracking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.train.html">das.train</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.train_tune.html">das.train_tune</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.utils.html">das.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.utils_plot.html">das.utils_plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.tcn.tcn.html">das.tcn.tcn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.tcn.tcn_new.html">das.tcn.tcn_new</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.morpholayers.constraints.html">das.morpholayers.constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.morpholayers.initializers.html">das.morpholayers.initializers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.morpholayers.layers.html">das.morpholayers.layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.morpholayers.regularizers.html">das.morpholayers.regularizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.kapre.augmentation.html">das.kapre.augmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.kapre.backend.html">das.kapre.backend</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.kapre.backend_keras.html">das.kapre.backend_keras</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.kapre.filterbank.html">das.kapre.filterbank</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.kapre.time_frequency.html">das.kapre.time_frequency</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/das.kapre.utils.html">das.kapre.utils</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="train">
<h1>Train<a class="headerlink" href="#train" title="Permalink to this headline">#</a></h1>
<p class="linemarker linemarker-2">Training a network involves two steps:</p>
<ol class="arabic simple">
<li><p class="linemarker linemarker-3">Make a dataset from exported annotations.</p></li>
<li><p class="linemarker linemarker-4">Configure and train a network.</p></li>
</ol>
<section id="make-a-dataset-from-exported-annotations">
<h2>Make a dataset from exported annotations<a class="headerlink" href="#make-a-dataset-from-exported-annotations" title="Permalink to this headline">#</a></h2>
<p class="linemarker linemarker-7">Training requires data in a specific format in which the audio is split into different parts for use during training to optimize the network and after training to evaluate network performance. The GUI automates the generation of these datasets from audio annotated using the GUI. Alternatively, you can also <a class="reference internal" href="../tutorials/convert.html"><span class="doc std std-doc">use your existing annotations</span></a> or <a class="reference internal" href="../tutorials/make_ds_notebook.html"><span class="doc std std-doc">make a dataset yourself</span></a>. For details on the data format itself, see <span class="xref myst">here</span>.</p>
<p class="linemarker linemarker-9">In the GUI, make a dataset via <em>DAS/Make dataset for training</em>. This will first ask you to select the folder with the exported audio and annotations, and then present a dialog with options for customizing the dataset creation:</p>
<figure class="align-default" id="xb-assemble-fig">
<a class="reference internal image-reference" href="../_images/xb_assemble.png"><img alt="assemble dataset" src="../_images/xb_assemble.png" style="width: 650px;" /></a>
<figcaption>
<p><span class="caption-text">Dialog for customizing a dataset for training.</span><a class="headerlink" href="#xb-assemble-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p class="linemarker linemarker-17"><em>Data folder</em> &amp; <em>Store folder</em>: The data folder contains your exported annotations (annotations as <code class="docutils literal notranslate"><span class="pre">*_annotations.csv</span></code>, audio as <code class="docutils literal notranslate"><span class="pre">*.npz</span></code> or <code class="docutils literal notranslate"><span class="pre">*.wav</span></code>). From these annotations, the dataset will be created and save in the store folder. By default, the store folder is the data folder with <code class="docutils literal notranslate"><span class="pre">.npy</span></code> appended. <em>Important: You can change the name of the store folder but the data folder must end in <code class="docutils literal notranslate"><span class="pre">.npy</span></code> for DAS to recognize the dataset.</em></p></li>
<li><p class="linemarker linemarker-18"><em>Make individual training targets</em>: By default, the dataset will contain targets for a single network that recognizes all annotated song types. To be able to train a network for specific song types, enable this option. Training specific networks for individual song types, instead of a single network for all song types, can sometimes improve performance.</p></li>
<li><p class="linemarker linemarker-19"><em>Width of events (seconds)</em>: Events are defined by a single time point — to make training more robust, events should are represented by a Gaussian with specified width (standard deviation).</p></li>
<li><p class="linemarker linemarker-20"><em>Gap between segments (seconds)</em>: To simplify post processing of segments, in particular for birdsong with its many syllable types, we found that introducing brief gaps between individual syllables (segments) simplifies post-processing the inferred annotations.</p></li>
<li><p class="linemarker linemarker-21"><em>Train/validation/test splits</em>: Typically, the data is split into three parts, which are used during different phases of training:</p>
<ul>
<li><p class="linemarker linemarker-22"><em>train</em>: optimize the network parameters during training</p></li>
<li><p class="linemarker linemarker-23"><em>validation</em>: monitor network performance during training and steer training (stop early or adjust learning rate)</p></li>
<li><p class="linemarker linemarker-24"><em>test</em>: independent data to assess network performance after training. This can be omitted when training on very little data.</p></li>
<li><p class="linemarker linemarker-25">Splits can be generated using a mixture of two strategies:</p>
<ul>
<li><p class="linemarker linemarker-26"><em>Split by files</em>: Use a fraction of files in the data folder for the specific split. Full files will be used for the split. Only works if you have multiple annotated files.</p></li>
<li><p class="linemarker linemarker-27"><em>Split by samples</em>: Select a fraction of data from every file in the data folder.</p></li>
</ul>
</li>
<li><p class="linemarker linemarker-28"><em>Recommendation</em>: If you have enough files, split <em>train</em> and <em>validation</em> by samples and split <em>test</em> by files that come from different individuals. That way your test set assesses how well the network generalizes to new individuals. If you have too few files or the specific song types do not appear in all files, split by samples.</p></li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p class="linemarker linemarker-31">The dataset can be inspected using the <a class="reference internal" href="../tutorials/inspect_dataset.html"><span class="doc std std-doc">inspect_dataset notebook</span></a> if you are curious or if training fails.</p>
</div>
</section>
<section id="train-das-using-the-gui">
<h2>Train DAS using the GUI<a class="headerlink" href="#train-das-using-the-gui" title="Permalink to this headline">#</a></h2>
<p class="linemarker linemarker-35">Configure a network and start training via <em>DAS/Train</em>. This will ask you select the dataset folder ending in <code class="docutils literal notranslate"><span class="pre">.npy</span></code> that you just created. Then, a dialog will allow you to customize the network to be trained.</p>
<figure class="align-default" id="xb-train-fig">
<a class="reference internal image-reference" href="../_images/xb_train.png"><img alt="train" src="../_images/xb_train.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-text">Train options</span><a class="headerlink" href="#xb-train-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p class="linemarker linemarker-43">Options are grouped into three sections:</p>
<p class="linemarker linemarker-45"><strong>Data set</strong>:</p>
<ul class="simple">
<li><p class="linemarker linemarker-46"><em>Data folder</em>: Folder with the assembled annotations. Name must end in <code class="docutils literal notranslate"><span class="pre">.npy</span></code></p></li>
<li><p class="linemarker linemarker-47"><em>Save folder</em>: Folder for saving the files generated during training (network model and parameters, test results). Defaults to the name of the data folder, with the suffix <code class="docutils literal notranslate"><span class="pre">.npy</span></code> replaced by <code class="docutils literal notranslate"><span class="pre">.res</span></code>.</p></li>
<li><p class="linemarker linemarker-48"><em>Prefix for saved files</em>: Files generated during training are named based on the time the training started (<code class="docutils literal notranslate"><span class="pre">YYYYMMDD_hhmmss</span></code>). You can add an informative prefix, for instance <code class="docutils literal notranslate"><span class="pre">pulsesine</span></code>. An underscore will be interleaved between the prefix and the timestamp. The resulting files will then start with something like <code class="docutils literal notranslate"><span class="pre">pulsesine_20201012_125534_</span></code>.</p></li>
<li><p class="linemarker linemarker-49"><em>Song type</em>: Select the song type you want the network to recognize. Defaults to blank (all annotated song types). Will be populated with training targets if you select <em>Make individual training targets</em> during dataset assembly.</p></li>
<li><p class="linemarker linemarker-50"><em>Data fraction</em> &amp; <em>Seed</em>: Use a random subset of the data from the training and validation splits. The seed gives you reproducibility. This does not affect the test set. That way you can train a network on different subsets of your data and test on the same dataset.</p></li>
</ul>
<p class="linemarker linemarker-52"><strong>Network parameters</strong>:</p>
<ul class="simple">
<li><p class="linemarker linemarker-53"><em>Downsampling frontend</em>: Trainable frontend initialized with STFT filters. Improves performance and speeds up training and inference for signals with high carrier frequencies relative to the amplitude or frequency modulation spectra - for instance ultrasonic vocalizations or bird song. Only works with single-channel, not with multi-channel audio.</p>
<ul>
<li><p class="linemarker linemarker-54"><em>Number of filters</em>: Number of filters per layer in the frontend.</p></li>
<li><p class="linemarker linemarker-55"><em>Filter duration (samples)</em>: Duration of the filters in the frontend.</p></li>
<li><p class="linemarker linemarker-56"><em>Downsample factor</em>: The output of the STFT will be downsampled by that factor (only every Nth sample will be taken) before being fed into the main TCN.</p></li>
</ul>
</li>
<li><p class="linemarker linemarker-57"><em>Chunk duration (samples)</em>: Number of samples processed at once. Defines an upper bound to the audio context available to the network.</p></li>
<li><p class="linemarker linemarker-58"><em>Number of filters</em>: Number of filters in each layer of the network. Vary between 16 and 32. Fewer typically decrease performance, more rarely help.</p></li>
<li><p class="linemarker linemarker-59"><em>Filter duration (samples)</em>: Duration of each filter in samples. Should correspond to the duration of the lowest level song feature (e.g. the carrier if training on raw audio without a downsampling frontend).</p></li>
<li><p class="linemarker linemarker-60"><em>Number of TCN blocks</em>: Number of TCN blocks in the network. Deeper networks (more TCN blocks) allow extracting more derived sound features. We found values between 2 and 6 blocks to work well.</p></li>
<li><p class="linemarker linemarker-61"><em>Separable TCN blocks</em>: Useful only for multi-channel audio. Whether the convolutions in individual TCN blocks should be separable by time and channel: In a separable convolution, each audio channel is first filtered with a set of filters and then the filtered channels are combined with a second set of filters. Allows sharing filters across channels - the idea is that some filtering operations should be applied to each channel equally. The first one or two TCN blocks can be set to use separable convolutions for multi-channel audio. Should be a space-separated sequence of <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> with the same length as the number of TCN blocks. For instance, a 5-block network with the first two blocks set to use separable convolutions would be: <code class="docutils literal notranslate"><span class="pre">True</span> <span class="pre">True</span> <span class="pre">False</span> <span class="pre">False</span> <span class="pre">False</span></code>.</p></li>
</ul>
<p class="linemarker linemarker-63"><strong>Training parameters</strong>:</p>
<ul class="simple">
<li><p class="linemarker linemarker-64"><em>Learning rate</em>: Determines by how much the parameters are updated in every step. Too small, and performance will take very long to improve, too large and performance will diverge. The optimal value depends on the network and data size but performance is relatively robust to the specific choice of value. Values between 0.1 and 0.0001 typically work.</p></li>
<li><p class="linemarker linemarker-65"><em>Reduce learning rate patience</em>: The learning rate can be reduced automatically if the performance on the validation set does not increase for the specified number of epochs. We did not find this to improve or speed up training much.</p></li>
<li><p class="linemarker linemarker-66"><em>Number of epochs</em>: Maximum number of training epochs. For training with small data sets during fast training, 10 epochs are typically sufficient. For training on larger datasets leave as is. Training will stop early if the performance on the validation set did not increase in the last 20 epochs.</p></li>
<li><p class="linemarker linemarker-67"><em>Create tensorboard logs</em>: Create tensorboard logs for monitoring training.</p></li>
</ul>
<p class="linemarker linemarker-69">Training can be started locally in a separate process or a script can be generated for training on the command line, for instance on a cluster.</p>
<section id="train-from-the-command-line">
<h3>Train from the command line<a class="headerlink" href="#train-from-the-command-line" title="Permalink to this headline">#</a></h3>
<p class="linemarker linemarker-72">The datasets are portable—you can copy the folder with the dataset to another computer with a GPU and run training from the GUI there. If that machine cannot be used with a GUI—for instance if it’s a linux server, the training and network configuration can be exported via the dialog as a command line script and executed via a terminal.</p>
<p class="linemarker linemarker-74">The script uses the command-line interface <code class="docutils literal notranslate"><span class="pre">das</span> <span class="pre">train</span></code> for training <em>DAS</em> (see also <a class="reference internal" href="../tutorials/train.html"><span class="doc std std-doc">train using command-line scripts</span></a>) and its contents will look like this:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>das<span class="w"> </span>train<span class="w"> </span>--data-dir<span class="w"> </span>/Users/DAS/tutorial/gui_demo.npy<span class="w"> </span>--save-dir<span class="w"> </span>/Users/DAS/tutorial/gui_demo.res<span class="w"> </span>--nb-hist<span class="w"> </span><span class="m">256</span><span class="w"> </span>--ignore-boundaries<span class="w"> </span>True<span class="w"> </span>--nb-filters<span class="w"> </span><span class="m">32</span><span class="w"> </span>--kernel-size<span class="w"> </span><span class="m">32</span><span class="w"> </span>--nb-conv<span class="w"> </span><span class="m">3</span><span class="w"> </span>--use-separable<span class="w"> </span>False<span class="w"> </span>False<span class="w"> </span>False<span class="w"> </span>--learning-rate<span class="w"> </span><span class="m">0</span>.0001<span class="w"> </span>--nb-epoch<span class="w"> </span><span class="m">400</span><span class="w"> </span>--model-name<span class="w"> </span>tcn<span class="w"> </span>--no-reduce-lr<span class="w">  </span>--no-tensorboard
</pre></div>
</div>
<p class="linemarker linemarker-79">For the script to work on a different machine, it likely require some edits:</p>
<ul class="simple">
<li><p class="linemarker linemarker-80"><code class="docutils literal notranslate"><span class="pre">--data-dir</span></code> needs to point to the dataset folder ending in <code class="docutils literal notranslate"><span class="pre">.npy</span></code> on the remote machine.</p></li>
<li><p class="linemarker linemarker-81"><code class="docutils literal notranslate"><span class="pre">--save-dir</span></code> needs to point to a valid, writable path.</p></li>
<li><p class="linemarker linemarker-82">Add a line to activate a specific conda environment before running <code class="docutils literal notranslate"><span class="pre">das</span> <span class="pre">train</span></code>. For instance, <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">activate</span> <span class="pre">das</span></code>.</p></li>
<li><p class="linemarker linemarker-83">Activate linux modules, for instance to enable CUDA; or specify parameters for your job scheduler.</p></li>
</ul>
</section>
</section>
<section id="files-generated-during-training">
<h2>Files generated during training<a class="headerlink" href="#files-generated-during-training" title="Permalink to this headline">#</a></h2>
<p class="linemarker linemarker-86">The following files will be created in the <em>save folder</em>:</p>
<ul class="simple">
<li><p class="linemarker linemarker-87"><code class="docutils literal notranslate"><span class="pre">_model.h5</span></code>: trained network model.</p></li>
<li><p class="linemarker linemarker-88"><code class="docutils literal notranslate"><span class="pre">_params.yaml</span></code>: info on data formats etc.</p></li>
<li><p class="linemarker linemarker-89"><code class="docutils literal notranslate"><span class="pre">_results.h5</span></code>: test results.</p></li>
</ul>
<p class="linemarker linemarker-91">The <code class="docutils literal notranslate"><span class="pre">_model.h5</span></code> and <code class="docutils literal notranslate"><span class="pre">_params.yaml</span></code> are required for using the network for predictions and need to be copied to your local machine if you train remotely.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="predict.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Predict</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="annotate.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Annotate song</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2021, Jan Clemens
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Train</a><ul>
<li><a class="reference internal" href="#make-a-dataset-from-exported-annotations">Make a dataset from exported annotations</a></li>
<li><a class="reference internal" href="#train-das-using-the-gui">Train DAS using the GUI</a><ul>
<li><a class="reference internal" href="#train-from-the-command-line">Train from the command line</a></li>
</ul>
</li>
<li><a class="reference internal" href="#files-generated-during-training">Files generated during training</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/tabs.js"></script>
    <script src="../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/js/lightbox-plus-jquery.min.js"></script>
    <script src="../_static/sphinxcontrib-images/LightBox2/lightbox2-customize/jquery-noconflict.js"></script>
    </body>
</html>